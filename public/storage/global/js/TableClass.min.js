/* 
  * TABLE CLASS PLUGIN 1.0.0
 * Date Created: Feb 11, 2016
 * Time Created: 2:36:33 PM
 * Module: TableClass
 * Project: TableClass Plugin
 * Version 1.0.0
 * Description: This Class Module convert ordinary table into 
 * responsive table and purely Objected Oriented table
 * Requirements: This Table Classs uses Bootstrap plugins for designs.
 * Author: Eng'r Nolan F. Sunico
 * Project: Arkema-Eleave
 */
function Dispatcher(){this.events=[]}function HideThisRow(a){var b=a;b>0&&$("#TableClassRowID-"+b).hide()}function DeleteThisRow(a,b){var c=!0;try{var d=b;d>0&&($("#TableClassRowID-"+d).remove(),d-=1),TableClass.prototype.RowChange(d),TableClass.prototype.UpdateTableRow(a)}catch(a){alert(a.message),c=!1}return c}function TableClassSelectRow(a,b){return TableClass.prototype.IsDisabled||($("#"+a+">tbody>tr").removeClass("highlight"),$("#TableClassRowID-"+b).addClass("highlight"),TableClass.prototype.CurrentRowIndex=b,TableClass.CurrentRowIndex=TableClass.prototype.CurrentRowIndex,TableClass.prototype.TableName=a,TableClass.prototype.SelectRow(b)),!0}function TableClassLeft(a,b){var c=a.substring(0,b);return c}function TableClassRight(a,b){var c=a.length,d=a.substring(c,b);return d}function TableClassStrlen(a){var b=a.length;return b}Dispatcher.prototype.addEventlistener=function(a,b){this.events[a]=this.events[a]||[],this.events[a]&&this.events[a].push(b)},Dispatcher.prototype.removeEventlistener=function(a,b){if(this.events[a])for(var c=this.events[a],d=c.length-1;d>=0;--d)if(c[d]===b)return c.splice(d,1),!0;return!1},Dispatcher.prototype.dispatch=function(a){if(this.events[a])for(var b=this.events[a],c=b.length;c--;)b[c](this)};var Table_Class_Selected_Row_Index,Table_Class_Current_Column_Index=0,TableClass=function(a,b){this.TableClassTheme={Default:0,Primary:1,Danger:2},$("head").append('<link rel="stylesheet" href="../js/TableClass.css" type="text/css" />'),Dispatcher.call(this),this.events=[],this.header=[],this.Table=$("#"+a+">tbody"),this.TableRows,this.Cells,TableClass.prototype.TableName=a,this.CurrentRowIndex=0,this.Table_Class_Selected_Row_Index=0,this.TableRows=$("#"+TableClass.prototype.TableName)[0];var c=$("#"+TableClass.prototype.TableName+">tbody>tr").length,d=this.TableRows.rows[0].cells.length;TableClass.prototype.rows=$("#"+TableClass.prototype.TableName+">tbody>tr"),TableClass.prototype.rowCount=TableClass.prototype.rows.length;var e=[],f=$("th"),h=($("#"+TableClass.prototype.TableName+">tbody>tr").each(function(a){$cells=$(this).find("td"),e[a]={},$cells.each(function(b){e[a][$(f[b]).html()]=$(this).html()})}),{});h.myRows=e,TableClass.prototype.rowsToJSON=JSON.stringify(h);var i="";switch(b||(b=0),b){case 0:i="btn-primary";break;case 1:i="btn-danger";break;case 2:i="btn-primary";break;default:i="btn-default"}TableClass.prototype.TableTheme=i,TableClass.prototype.IsDisabled=!1,$("#"+TableClass.prototype.TableName+">thead>tr").addClass(i),$("#"+TableClass.prototype.TableName).addClass("table table-bordered table-responsive table-striped table-hover");try{for(n=0;n<d;n++){var j=this.TableRows.rows[0].cells[n];this.header[n]=j.innerHTML.toLowerCase()}for(var k=1;k<=c;k++){var l=this.TableRows.rows[k],m=$(l);m.attr("id","TableClassRowID-"+k),m.attr("onclick",'TableClassSelectRow("'+TableClass.prototype.TableName+'",'+k+")");for(var n=0;n<d;n++){var j=this.TableRows.rows[0].cells[n],o=$(j),p=o.css("text-align"),q=o.css("display"),r=o.attr("datatype"),s=this.TableRows.rows[k].cells[n],t=$(s),u="";switch(r&&(u=r.toLowerCase()),u){case"n":break;case"n2":var v=TableClass.prototype.TableClassFormat(t.html(),2);t.html(v);break;case"n3":var v=TableClass.prototype.TableClassFormat(t.html(),3);t.html(v);break;case"n4":var v=TableClass.prototype.TableClassFormat(t.html(),4);t.html(v)}t.css("text-align",p),""!=q&&t.css("display",q)}}$(document).ready(function(){var b=$("#"+a)[0],c=b.rows[0].cells.length,d=0,e=-1;$("#"+a+" tbody td").click(function(){var a=parseInt($(this).index())+1;TableClass.prototype.ColumnID=a}),$("#"+a).on("keydown",function(b){var f=$("#"+a+">tbody>tr").length,g=b.which;switch(g){case 37:d=TableClass.prototype.CurrentRowIndex,e=Table_Class_Current_Column_Index,e-=1,e<0&&(e=0),Table_Class_Current_Column_Index=e;break;case 38:d=TableClass.prototype.CurrentRowIndex-1,d<1&&(d=1);break;case 40:d=TableClass.prototype.CurrentRowIndex+1,d>f&&(d=f);break;case 39:d=TableClass.prototype.CurrentRowIndex,e=Table_Class_Current_Column_Index,e+=1,e>=c&&(e=c-1),Table_Class_Current_Column_Index=e;break;case 46:d=TableClass.prototype.CurrentRowIndex,d>f&&(d=f),TableClass.prototype.DeleteRow(d),d-=1}TableClass.prototype.TableName=a,TableClass.prototype.SelectRow(d),TableClass.prototype.CurrentRowIndex=d})})}catch(a){}};TableClass.prototype.TableCell=function(a,b){var c=TableClass.prototype.CurrentRowIndex,d=$("#"+TableClass.prototype.TableName)[0],e=d.rows[c].cells[a],f=$(e);f.html(b)},TableClass.prototype.TableTheme=function(){},TableClass.prototype.TableName=function(){},TableClass.prototype.IsDisabled=function(){},TableClass.prototype.ColumnID=function(){},TableClass.prototype.CurrentRowIndex=function(){},TableClass.prototype.CurrentColumnIndex=function(){},TableClass.prototype.Enable=function(a){TableClass.prototype.IsDisabled=!a,$("#"+TableClass.prototype.TableName+">thead>tr").removeClass(),$("#"+TableClass.prototype.TableName+">tfoot>tr").removeClass();var b=$("#"+TableClass.prototype.TableName).css("font-size");a?($("#"+TableClass.prototype.TableName+">thead>tr").addClass(TableClass.prototype.TableTheme),$("#"+TableClass.prototype.TableName+">tfoot>tr").addClass(TableClass.prototype.TableTheme),$("#"+TableClass.prototype.TableName).css("cssText","font-size: "+b+";cursor: default !important")):($("#"+TableClass.prototype.TableName+">thead>tr").addClass("btn-defafult"),$("#"+TableClass.prototype.TableName+">tfoot>tr").addClass("btn-defafult"),$("#"+TableClass.prototype.TableName).removeClass("table-hover"),$("#"+TableClass.prototype.TableName).css("cssText","font-size: "+b+";cursor: not-allowed !important"))},TableClass.prototype.rowsToJSON=function(){},TableClass.prototype.rowCount=function(){},TableClass.prototype.rows=function(){},TableClass.prototype.UpdateTableRow=function(a){for(var b=$("#"+a+">tbody>tr").length,c=1;c<=b;c++){var d=this.TableRows.rows[c],e=$(d);for(e.attr("id","TableClassRowID-"+c),e.attr("onclick",'TableClassSelectRow("'+this.TableName+'",'+c+")"),i=0;i<colCount;i++){var f=this.TableRows.rows[0].cells[i],g=$(f),h=g.css("text-align"),j=g.attr("datatype"),k=this.TableRows.rows[c].cells[i],l=$(k),m="";switch(j&&(m=j.toLowerCase()),m){case"n":break;case"n2":var n=TableClass.prototype.TableClassFormat(l.html(),2);l.html(n);break;case"n3":var n=TableClass.prototype.TableClassFormat(l.html(),3);l.html(n);break;case"n4":var n=TableClass.prototype.TableClassFormat(l.html(),4);l.html(n)}l.css("text-align",h)}}},TableClass.prototype.DeleteRow=function(a){try{var b=$("#"+this.TableName)[0],c=$.Event("DeleteRow"),d=b.rows[a].cells;d=TableClass.prototype.AddMethod(d),c.index=a,c.cell=d,c.RemoveRow=function(){DeleteThisRow(this.TableName,a)},c.HideRow=function(){TableClass.prototype.HideRow(a)},$("#"+this.TableName).trigger(c)}catch(a){}},TableClass.prototype.RowChange=function(a){var b=$("#"+this.TableName)[0],c=$.Event("RowChange"),d=$("#"+this.TableName+" tbody tr td");d.removeClass("highlightcell"),c.index=a,c.columnindex=TableClass.prototype.ColumnID-1,c.disabled=TableClass.prototype.IsDisabled;var e=b.rows[0].cells;e=TableClass.prototype.AddMethod(e),c.HeaderCell=e;var f=b.rows[a].cells,g=$(f[c.columnindex]);g.addClass("highlightcell"),f=TableClass.prototype.AddMethod(f),c.cells=f,TableClass.prototype.CurrentRowIndex=a,$("#"+this.TableName).trigger(c)},TableClass.prototype.AddMethod=function(a){var b=a.length;for(i=0;i<b;i++){var c=a[i].innerHTML,d=c.replace(",","");isNaN(d)?(a[i].text=c,a[i].value=0,a[i].FormatValue=0):(a[i].value=TableClass.prototype.TableClassToFloat(d,2),a[i].text=c,a[i].FormatValue=TableClass.prototype.TableClassFormat(d,2))}return a},TableClass.prototype.FormatTableCells=function(a,b){this.TableRows=$("#"+a)[0];var c=this.TableRows.rows[b].cells,d=this.TableRows.rows[0].cells,e=d.length;for(i=0;i<e;i++){var f=d[i],g=$(f),h=$(c[i]),j=TableClass.prototype.CSS(g),k=g.css("text-align"),l=g.attr("datatype"),m="";switch(l&&(m=l.toLowerCase()),m){case"n":break;case"n2":var n=TableClass.prototype.TableClassFormat(h.html(),2);h.html(n);break;case"n3":var n=TableClass.prototype.TableClassFormat(h.html(),3);h.html(n);break;case"n4":var n=TableClass.prototype.TableClassFormat(h.html(),4);h.html(n)}h.css("text-align",k),"none;"==j.display&&h.css("display","none")}},TableClass.prototype.CSS=function(a){try{var b=document.styleSheets,c={};for(var d in b){var e=b[d].rules||b[d].cssRules;for(var f in e)a.is(e[f].selectorText)&&(c=$.extend(c,TableClass.prototype.CSS2JSON(e[f].style),TableClass.prototype.CSS2JSON(a.attr("style"))))}return c}catch(a){}},TableClass.prototype.CSS2JSON=function(a){var b={};if(!a)return b;if(a instanceof CSSStyleDeclaration)for(var c in a)a[c].toLowerCase&&(b[a[c].toLowerCase()]=a[a[c]]);else if("string"==typeof a){a=a.split("; ");for(var c in a){var d=a[c].split(": ");b[d[0].toLowerCase()]=d[1]}}return b},TableClass.prototype.InsertRow=function(){var a=$("#"+this.TableName)[0],b=$("#"+TableClass.prototype.TableName+">tbody>tr").length,c=arguments,d=arguments.length,e=$("#"+TableClass.prototype.TableName+">tbody>tr").length+1;TableClass.prototype.CurrentRowIndex=e;var f="<tr id='TableClassRowID-"+e+"' onclick='TableClassSelectRow(\""+this.TableName+'",'+e+")'>\n";for(i=0;i<d;i++)f+="<td>"+c[i]+"</td>\n";f+="</tr>\n",this.Table.length<=0&&(this.Table=$("#"+this.TableName),this.Table.append("<tbody></tbody>"),this.Table=$("#"+this.TableName+">tbody")),this.Table.append(f),this.Rows=a.rows[e];var g=a.rows[b].cells;return g=TableClass.prototype.AddMethod(g),this.cells=g,TableClass.prototype.FormatTableCells(this.TableName,e),TableClass.prototype.RowChange(e),TableClass.prototype.rowCount=e,this.Rows},TableClass.prototype.DeleteAllRows=function(){var a=!1;try{$("#"+this.TableName+">tbody>tr").remove(),TableClass.prototype.CurrentRowIndex=0,a=!0}catch(b){alert(b.message),a=!1}return a},TableClass.prototype.CurrentCell=function(a,b){var c="",d=0;void 0==b&&(b=TableClass.prototype.CurrentRowIndex);try{d=isNaN(a)?this.header.indexOf(a.toLowerCase()):a,d>=0?c=this.TableRows.rows[b].cells[d].innerHTML:alert("We could not find header '"+a+"'!")}catch(a){}return c},TableClass.prototype.HideRow=function(a){HideThisRow(a)},TableClass.prototype.DeleteCurrentRow=function(){TableClass.prototype.DeleteRow(TableClass.prototype.CurrentRowIndex)},TableClass.prototype.SelectRow=function(a){try{var b=$("#"+this.TableName)[0];$("#"+this.TableName+">tbody>tr").removeClass("highlight"),$("#TableClassRowID-"+a).addClass("highlight"),TableClass.prototype.CurrentRowIndex=a,this.CurrentRowIndex=TableClass.prototype.CurrentRowIndex,this.Rows=b.rows[a],TableClass.prototype.RowChange(a),TableClass.prototype.SelectColumn(this.TableName,a,0)}catch(a){alert(a.message)}return this.Rows},TableClass.prototype.SearchRow=function(a,b){var c=0;try{for(var d=$("#"+TableClass.prototype.TableName)[0],e=$("#"+TableClass.prototype.TableName+">tbody>tr").length,f=1;f<=e;f++){var g=d.rows[f].cells,h=$(g[a]),i=h.html();if(i==b)return TableClass.prototype.SelectRow(f),c=f}return c}catch(a){alert(a.message)}},TableClass.prototype.SelectColumn=function(a,b,c){try{}catch(a){alert(a.message)}return this.Rows},TableClass.prototype.TableClassFormat=function(a,b){"undefined"==typeof b&&(b=2);var c=".",d=",";a=parseFloat(a);var e=a<0?"-":"",f=new String(a.toFixed(b));c.length&&"."!=c&&(f=f.replace(/\./,c));var g="",h="",i=new String(f),j=c.length?i.indexOf(c):-1;for(j>-1?(j&&(g=i.substr(0,j)),h=i.substr(j+1)):g=i,g&&(g=String(Math.abs(g)));h.length<b;)h+="0";for(temparray=new Array;g.length>3;)temparray.unshift(g.substr(-3)),g=g.substr(0,g.length-3);return temparray.unshift(g),g=temparray.join(d),e+g+c+h},TableClass.prototype.TableClassToFloat=function(a,b){"undefined"==typeof b&&(b=2);var c=a.replace(",","").replace(" ","");c=c.replace(",","").replace(" ",""),c=parseFloat(c);var c=c.toFixed(b);return c};

