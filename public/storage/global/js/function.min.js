/* 
 * Copyright(C)2016 A6178879
 *
 * All rights reserved Arkema Pte. Ltd.(international.ic.corp.local)
 * Website Developed by: Eng'r Nolan F. Sunico
 * Date Created: Feb 17, 2016
 * Time Created: 11:27:49 AM
 * Module: function
 * Project: Arkema-Eleave
 */
/* Document Jquery  */
function InitializeLeaveDateInput(){$(".leave-date").jqxDateTimeInput({width:"auto",height:"28px",formatString:"MM/dd/yyyy",disabled:!0})}function DisableDeveloperTools(){$(document).keydown(function(e){return alert(e.keyCode),123==e.keyCode?!1:e.ctrlKey&&e.shiftKey&&73==e.keyCode?!1:void 0})}function IntegerToBoolean(e){var a=0;return a=1==e?!0:!1}function BooleanToInteger(e){var a=0;return a=e?1:0}function InitializeProfileImports(){var e=$("#btnImportFile"),a=$("#UploadProgress"),t="";new AjaxUpload(e,{action:"upload-import-file.php",data:{},name:"fileUpload",autoSubmit:!0,disabled:!0,onSubmit:function(e,r){var o=$("#CompanyDropdownList").select2("val"),l=$("#SiteList").select2("val");return $("#ImportStatus").removeClass(),0>=l?(t="Select Site before you can proceed!",MessageBoxAlert(t,BootstrapDialog.TYPE_WARNING),$("#ImportStatus").html("No Site Selected"),$("#ImportStatus").addClass("alert alert-warning"),!1):0>=o?(t="Select Company before you can proceed!",MessageBoxAlert(t,BootstrapDialog.TYPE_WARNING),$("#ImportStatus").html("No Company Selected"),$("#ImportStatus").addClass("alert alert-warning"),!1):"xlsx"==r||"xlx"==r?(a.attr("src","../images/wait_progress.gif"),$("#ImportStatus").html("Upload Successful"),$("#ImportStatus").addClass("alert alert-success"),!0):(t='This File "'+e+'" is not allowed to upload.\n',t+="<b>File Type Currently Supported:</b> Microsoft Excel(xlsx,xlx)",MessageBoxAlert(t,BootstrapDialog.TYPE_WARNING),$("#ImportStatus").html("File not Allowed"),$("#ImportStatus").addClass("alert alert-danger"),!1)},onComplete:function(e,t){try{a.attr("src","");var r=t;""!=r&&($("#FileImport").val(r),$("#ImportFilename").html(e),$("#btnAnalyze").prop("disabled",!1),$("#ImportStatus").html())}catch(o){alert(o.message)}}})}function InitializeUploadFiles(e,a){var t=$("#btnAddFiles"),r=$("#UploadProgress"),o=$("#_AllowEdit").val();new AjaxUpload(t,{action:"upload-file.php",data:{lid:e,il:a},name:"fileUpload",autoSubmit:!0,disabled:!0,onSubmit:function(e,a){$("#_RowStatusID").val();if(1!=o)return!1;if(EvaluateFiles(a))return r.attr("src","../images/wait_progress.gif"),!0;var t='This File "'+e+'" is not allowed to upload.\n';return t+="<b>File Type Currently Supported:</b> "+SupportedFiles+"...",MessageBoxAlert(t,BootstrapDialog.TYPE_WARNING),!1},onComplete:function(a,t){try{r.attr("src","");var o=t;if(""!=o){var l=new DownloadFileList;l.AddRow(a,o,o,e),l.AppendToTable("FileAttachments"),InitializeBootstrapTooltips(),BindFileAttachments()}}catch(n){alert(n.message)}}})}function MessageBoxDeleteAttachment(e,a){"undefined"===a&&(a=BootstrapDialog.TYPE_INFO),BootstrapDialog.alert({title:AppName,message:e,type:a,closable:!0,draggable:!0,btnOKLabel:"Yes",btnCancelLabel:"No",btnOKClass:"btn-info",callback:function(){document.getElementById("FileAttachments").deleteRow(FileAttachmentsIndex)}})}function ReloadPage(){window.location.reload()}function CancelReload(){}function UpdateBalanceProfileINTODatabase(e,a){var t="";void 0==a?(a="Balance Profile Successfully Imported!",t="CancelReload"):t="ReloadPage",$.ajax({type:"POST",url:"../class/ajax.php",data:{Param:e,nIndex:36},success:function(e,r){var o=r;return o&&0==e?(MessageBoxAlert(a,BootstrapDialog.TYPE_INFO,t),!0):void 0}})}function ImportBalanceProfileINTODatabase(e,a){var t="CancelReload";void 0==a?(a="Balance Profile Successfully Imported!",t="CancelReload"):t="ReloadPage",$.ajax({type:"POST",url:"../class/ajax.php",data:{Param:e,nIndex:32},success:function(e,t){var r=t;return r&&0==e?(MessageBoxAlert(a,BootstrapDialog.TYPE_INFO),!0):void 0}})}function DeleteFiles(e){var a=$("#_LeaveID").val();BootstrapDialog.confirm({title:AppName,message:"Are you sure you want to delete this attachment?",type:BootstrapDialog.TYPE_WARNING,closable:!0,draggable:!0,btnOKLabel:"Yes",btnCancelLabel:"No",btnOKClass:"btn-info",callback:function(t){t&&$.ajax({type:"POST",url:"delete.php",data:{file:e,lid:a},success:function(a,t){var r=t;return r?void MessageBoxDeleteAttachment("'"+e+"' Successfully Deleted!",BootstrapDialog.TYPE_INFO):void 0}})}})}function ExportExcelUserList(e,a,t,r,o){$.ajax({type:"GET",url:"export-balance-profile.php",data:{cid:e,sid:a,cmi:t,did:r,sit:o},success:function(e,a){var t=a;t&&(url="../temp/BalanceProfile.xlsx",location=url)}})}function GetFileNameOnly(e){var a=e.match(/[^\/\\]+$/);return String(a)}function Left(e,a){var t=e.substring(0,a);return t}function Right(e,a){var t=e.length,r=e.substring(t,a);return r}function strlen(e){var a=e.length;return a}function BindFileAttachments(){$("#FileAttachments tr").click(function(){FileAttachmentsIndex=this.rowIndex})}function ViewProgressBar(){$("#ShowHideProgress").removeClass("leave-progress"),$("#ShowHideProgress").addClass("leave-progress-start")}function hexc(e){var a=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete a[0];for(var t=1;3>=t;++t)a[t]=parseInt(a[t]).toString(16),1==a[t].length&&(a[t]="0"+a[t]);var r="#"+a.join("");return r}function HideProgressBar(){$("#ShowHideProgress").removeClass("leave-progress-start"),$("#ShowHideProgress").addClass("leave-progress")}function ShowAddCreditLeaveHistory(){$("#CreditLeaveHistoryModal").modal("show")}function ShowWokFlow(){$("#workflowModal").modal("show")}function MakeActive(e){$(".nav li").removeClass("active"),$("#"+e).addClass("active")}function InitializeEleaveCalendar(e){$(".eleave-calendar").jqxCalendar({width:"170px",height:"143px",selectionMode:"range"});for(var a=1;12>=a;a++){var t=a+"/1/"+e;$("#EleaveCalendar"+a).jqxCalendar("setDate",new Date(t))}$("#EleaveCalendar1").jqxCalendar("setDate",new Date("1/15/2016")),$("#EleaveCalendar1").jqxCalendar("setDate",new Date("1/19/2016"))}function InitializeSelect2(){$(".cboSelect2").select2({formatResult:format})}function addUserPic(e){var a=$('<span class="glyphicon glyphicon-user">sdssdsd'+$(e.element).text()+"</span>");return a}function format(e){var a=e.element;return'<i class="glyphicon glyphicon-'+$(a).data("icon")+'"></i> '+e.text}function InitializeBootstrapTooltips(){}function HideBootstrapTooltips(){try{$('[data-toggle="popover"]').popover("hide")}catch(e){}}function ShowModalDialog(e,a,t,r){var o=$("<div></div>").load(e),l=$.extend({title:$("#AppTitle").html(),size:BootstrapDialog.SIZE_NORMAL,icon:"glyphicon glyphicon-floppy-disk",autoclosable:!1,closable:!1,oklabel:"OK",idOK:"btnOK",idCancel:"btnCancel",cancellabel:"Cancel",cssClass:"btn-primary"},a);BootstrapDialog.show({title:l.title,size:l.size,buttons:[{id:l.idOK,icon:l.icon,label:l.oklabel,cssClass:l.cssClass,action:function(e){window[t](arguments),e.close()}},{label:l.cancellabel,action:function(e){window[r](arguments),e.close()}}],autoclosable:l.autoclosable,closable:l.closable,message:o})}function ShowContactUs(){var e=$("#AppTitle").html();try{BootstrapDialog.show({title:e,width:200,autoclosable:!1,message:$("<div></div>").load("contactus.php?action=display")})}catch(a){alert(a.message)}InitializeBootstrapTooltips()}function CloseBootStrapDialog(){BootstrapDialog.closeAll()}function SendContactUsSubmit(){var e=$("#ContactName").val(),a=$("#ContactEmail").val(),t=$("#ContactMessage").text();return""==e||""==a||""==t?(MessageBoxEx("Please fill up the required fields.",BootstrapDialog.TYPE_DANGER,""),1):void $.ajax({type:"POST",url:"../pages/sendcontactus.php",data:{cname:e,cmail:a,cmessage:t},success:function(e,a){var t=a;t&&("OK"==e?MessageBoxEx("Email Successfully Sent.",BootstrapDialog.TYPE_INFO,"Close"):MessageBoxEx("Email Failed to Sent.",BootstrapDialog.TYPE_DANGER,"Close"))}})}function MessageBoxEx(e,a,t,r){"undefined"===a&&(a=BootstrapDialog.TYPE_INFO),BootstrapDialog.confirm({title:AppName,message:e,type:a,closable:!0,draggable:!0,btnOKLabel:"Yes",btnCancelLabel:"No",btnOKClass:"btn-info",callback:function(e){return e?(window[t](arguments),!0):(void 0!=r&&window[r](arguments),!1)}})}function MessageBoxAlert(e,a,t){BootstrapDialog.show({message:e,closable:!1,title:AppName,type:a,buttons:[{label:"Ok",cssClass:"btn-warning",action:function(e){return void 0==t?void e.close():void window[t](arguments)}}]})}function PadNumber(e){return 10>e?"0"+e:e}function FormatDate(e,a){var t="";if(void 0==a&&(a="mm/dd/yyyy"),null==e)return null;var r=new Date(e);switch(a){case"mm/dd/yyyy":t=[PadNumber(r.getMonth()+1),PadNumber(r.getDate()),r.getFullYear()].join("/");break;case"dd/mm/yyyy":t=[PadNumber(r.getDate()),PadNumber(r.getMonth()+1),r.getFullYear()].join("/");break;case"mm-dd-yyyy":t=[PadNumber(r.getMonth()+1),PadNumber(r.getDate()),r.getFullYear()].join("-");break;case"yyyy-mm-dd":t=[r.getFullYear(),PadNumber(r.getMonth()+1),PadNumber(r.getDate())].join("-");break;case"dd-mm-yyyy":t=[PadNumber(r.getDate()),PadNumber(r.getMonth()+1),r.getFullYear()].join("-");break;case"y,m,d":t=[r.getFullYear(),r.getMonth()-1,r.getDate()].join(",")}return t}function UncheckBoxes(){$("#LeaveHalfDayAM").jqxRadioButton({checked:!1}),$("#LeaveHalfDayPM").jqxRadioButton({checked:!1}),$("#LeaveFourthDay").jqxRadioButton({checked:!1})}function ComputeDaysApplied(e){var a=($("#LeaveHalfDayAM").jqxRadioButton("checked"),$("#LeaveHalfDayPM").jqxRadioButton("checked"),$("#LeaveFourthDay").jqxRadioButton("checked")),t=$("#LeaveRecipient").select2("val"),r=$("#_LeaveCompanyID").val(),o=FormatDate($("#LeaveStartDate").jqxDateTimeInput("getDate"),"yyyy-mm-dd"),l=FormatDate($("#LeaveEndDate").jqxDateTimeInput("getDate"),"yyyy-mm-dd"),n=$("#LeaveTypeList").select2("val");if(!e&&a){var s="You are not allowed to have One Fourth day Leave\nBased on the configuration of your Site <strong>'"+Site+"'</strong>.";s+="\n<b>Please contact your local HR!</b>",MessageBoxAlert(s,BootstrapDialog.TYPE_DANGER),UncheckBoxes(),GetTotalDaysApplied(t,r,o,l,n)}else GetTotalDaysApplied(t,r,o,l,n)}function UpdateApproverCostCenterOwner(){var e=$("#CostCenter").select2("val"),a=$("#CostCenterOwner").select2("val"),t=$("#ApproverConfigCountry").select2("val"),r=$("#CompanyDropdownBySiteList").select2("val"),o=$("#SiteList").select2("val"),l=$("#DepartmentDropdownByCompanyList").select2("val"),n=e+"|"+a;$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:19,Param:n},success:function(a,n){var s=n;s&&(window.location="../pages/approver-config.php?cid="+t+"&sid="+o+"&sdid="+l+"&cmid="+r+"&scid="+e)}})}function InsertUpdateAnnualLeaveAllocations(){var e=$("#_AnnualLeaveAllocationID").val(),a=$("#EmploymentCategoryList").select2("val"),t=$("#LengthOfService").select2("val"),r=$("#LeaveBalanceCountry").select2("val"),o=$("#CompanyDropdownList").select2("val"),l=$("#SiteList").select2("val"),n=$("#_RowIndex").val(),s=$("#EntitledLeave").val(),i=0;i=e>0?2:0;var c=$("#LeaveTypeList").select2("val"),d=$("#LeaveAllocationPopulateAllYears").jqxCheckBox("checked")?1:0,v=e+"|"+a+"|"+l+"|"+o+"|"+t+"|"+s+"|"+c+"|"+d+"|"+SelectedYears+"|"+i;$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:15,Param:v},success:function(e,s){var i=s;i&&(window.location="../pages/leave-allocations.php?cn="+r+"&ec="+a+"&si="+l+"&ltd="+c+"&ls="+t+"&ri="+n+"&ci="+o)}})}function CheckIfHolidayExist(e,a){var t=e+"|"+FormatDate(a,"yyyy-mm-dd");$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:14,Param:t},success:function(e,a){var t=a;t&&(alert(e),HolidayExist=e)}})}function InsertUpdateCompanySiteXML(){var e=new XMLWriter;e.BeginNode("entry"),e.BeginNode("companysites");for(var a=$("#tblCompanySite>tbody>tr").length,t=$("#tblCompanySite")[0],r=1;a>=r;r++){var o=t.rows[r].cells,l=o[6].innerHTML;1!=parseInt(l)&&(e.BeginNode("companysite"),e.Node("CompanySiteID",o[0].innerHTML),e.Node("CountryID",o[1].innerHTML),e.Node("CompanyID",o[2].innerHTML),e.Node("SiteID",o[3].innerHTML),e.Node("RowStatus",l),e.EndNode())}e.EndNode(),e.EndNode(),e.Close();var n=e.xml();ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:18,Param:n},success:function(e,a){var t=a,r=e.split("|");if(t)if(parseInt(r[3])>=0){var o=r[1],l=r[2];""==o&&(o=$("#CompanySiteCountry").select2("val")),""==l&&(l=$("#SiteList").select2("val")),document.location="company-sites.php?cid="+o+"&sid="+l}else MessageBoxAlert("Error Saving/Submitting LeaveType Site, \nPlease Check your data.",BootstrapDialog.TYPE_DANGER),HideProgressBar()}})}function InsertUpdateLeaveTypeSitesXML(e,a){var t=new XMLWriter;t.BeginNode("entry"),t.BeginNode("leavetypesites");var r=$("#tblIncludedLeaveType>tbody>tr").length,o=$("#tblIncludedLeaveType")[0];try{for(var l=1;r>=l;l++){var n=o.rows[l].cells,s=n[0].innerHTML,i=n[1].innerHTML,c=n[2].innerHTML,d=n[3].innerHTML,v=n[6].innerHTML,p=n[7].innerHTML,u=n[8].innerHTML,y=n[9].innerHTML,m=n[10].innerHTML,g=n[11].innerHTML,L=n[12].innerHTML,D=n[13].innerHTML;1!=parseInt(d)&&(t.BeginNode("leavetypesite"),t.Node("LeaveTypeSiteID",s),t.Node("LeaveTypeID",i),t.Node("SiteID",e),t.Node("CompanyID",a),t.Node("Message",c),t.Node("ShowMarriageDate",v),t.Node("ShowBabyBirthday",p),t.Node("IncludeHolidays",u),t.Node("IncludeWeekEnd",y),t.Node("IncludeRestDays",m),t.Node("AutoDistribution",g),t.Node("IsProRata",D),t.Node("LeaveAllocationLimit",CurrencyFormat(L,2)),t.Node("RowStatus",d),t.EndNode())}}catch(h){alert(h.message)}t.EndNode(),t.EndNode(),t.Close();var f=t.xml();ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:16,Param:f},success:function(e,t){var r=t,o=e.split("|");if(r)if(parseInt(o[2])>=0){var l=o[0],n=o[1];document.location="leavetype-sites.php?cid="+n+"&sid="+l+"&cmid="+a}else MessageBoxAlert("Error Saving/Submitting LeaveType Site, \nPlease Check your data.",BootstrapDialog.TYPE_DANGER),HideProgressBar()}})}function ShowLeaveSiteSetting(e,a){var t=e+"|"+a;$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:17,Param:t},success:function(e,a){var t=e.split("|"),r=parseInt(t[1]),o=parseInt(t[2]);1==r?$("#DivLeaveMarriage").show():$("#DivLeaveMarriage").hide(),1==o?$("#DivLeaveShowBabyBirthday").show():$("#DivLeaveShowBabyBirthday").hide()}})}function InsertUpdateEmploymentStatusXML(){var e=new XMLWriter;e.BeginNode("entry"),e.BeginNode("employmentstatus");var a=tEmp.rowCount;for(i=1;i<=a;i++)e.BeginNode("employmentstatusrows"),e.Node("EmploymentStatusID",tEmp.CurrentCell(0,i)),e.Node("SiteID",tEmp.CurrentCell(1,i)),e.Node("EmploymentStatus",tEmp.CurrentCell(5,i)),e.Node("CountryID",tEmp.CurrentCell(2,i)),e.Node("DefaultAnnualLeaveDays",tEmp.CurrentCell(6,i)),e.Node("RowStatus",tEmp.CurrentCell(3,i)),e.EndNode();e.EndNode(),e.EndNode(),e.Close();var t=e.xml();ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:11,Param:t},success:function(e,a){var t=a;t&&(parseInt(e)>=0?document.location="employment-status.php":(MessageBoxAlert("Error Saving/Submitting Employment Status, \nPlease Check your data.",BootstrapDialog.TYPE_DANGER),HideProgressBar()))}})}function InsertUpdateLeaveCreditXML(e){var a="";a=0==e?"0":"1";var t=new XMLWriter;t.BeginNode("entry"),t.BeginNode("creditleave"),t.Node("CreditLeaveID",$("#_CreditLeaveID").val()),t.Node("UserID",UserID);var r=$("#LeaveCreditDate").jqxDateTimeInput("getDate");t.Node("DateApplied",FormatDate(r,"yyyy-mm-dd")),t.Node("TotalDays",$("#TotalDaysCount").html()),t.Node("CreditLeaveStatusID",$("#_CreditLeaveStatusID").val()),t.Node("Comments",$("#LeaveCreditComment").text()),t.Node("IsSubmit",a),t.Node("StatusID",$("#_RowStatusID").val()),t.EndNode();var o=tclass.rowCount;for(t.BeginNode("creditleavedetails"),i=1;i<=o;i++)t.BeginNode("creditleavedetail"),t.Node("CreditLeaveDetailsID",tclass.CurrentCell(0,i)),t.Node("StartDate",FormatDate(tclass.CurrentCell(3,i),"yyyy-mm-dd")),t.Node("EndDate",FormatDate(tclass.CurrentCell(4,i),"yyyy-mm-dd")),t.Node("DetailStatus",tclass.CurrentCell(6,i)),t.Node("IsWholeDay",tclass.CurrentCell(7,i)),t.EndNode();t.EndNode(),t.Close();var l=t.xml();ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:9,Param:l},success:function(e,a){var t=a;if(t){var r=e.split("|");parseInt(r[1])>=0?document.location="leave-credit-application.php?action=view&id="+r[0]:(MessageBoxAlert("Error Saving/Submitting Leave Credit Application, \nPlease Check your data.",BootstrapDialog.TYPE_DANGER),HideProgressBar())}}})}function CurrencyFormat(e,a){"undefined"==typeof a&&(a=2);var t=".",r=",";e=parseFloat(e);var o=0>e?"-":"",l=new String(e.toFixed(a));t.length&&"."!=t&&(l=l.replace(/\./,t));var n="",s="",i=new String(l),c=t.length?i.indexOf(t):-1;for(c>-1?(c&&(n=i.substr(0,c)),s=i.substr(c+1)):n=i,n&&(n=String(Math.abs(n)));s.length<a;)s+="0";for(temparray=new Array;n.length>3;)temparray.unshift(n.substr(-3)),n=n.substr(0,n.length-3);return temparray.unshift(n),n=temparray.join(r),o+n+t+s}function StringToFloat(e,a){"undefined"==typeof a&&(a=2);var t=e.replace(",","").replace(" ","");t=t.replace(",","").replace(" ",""),t=parseFloat(t);var t=t.toFixed(a);return t}function EnableLeaveControl(e){if($(".leave-control").prop("disabled",!e),$(".leave-date").jqxDateTimeInput({disabled:!e}),$("#LeaveEditButton").prop("disabled",e),$("#btnAddFiles").prop("disabled",!e),$(".leave-check").jqxRadioButton({disabled:!e}),e){var a=$("#_RowStatusID").val();0==a?$("#_RowStatusID").val(0):$("#_RowStatusID").val(2)}}function GetTotalDaysApplied(e,a,t,r,o){var l=e+"|"+a+"|"+t+"|"+r+"|"+o;return null==t?0:void $.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:1,Param:l},success:function(e,a){var t=a;if(t){var r=parseInt(e),o="";o=r>1?" Days.":" Day.";var l=CurrencyFormat(r),n=$("#LeaveHalfDayAM").jqxRadioButton("checked"),s=$("#LeaveHalfDayPM").jqxRadioButton("checked"),i=$("#LeaveFourthDay").jqxRadioButton("checked"),c=0;n||s?c=.5:i&&(c=.75),l=CurrencyFormat(l-c),isNaN(l)&&(l=0);var d=0;0==IsPaid?($("#eLeaveCurrentYearEntitled").html("0.00"),$("#eLeaveTotalDaysApplied").html("0.00"),$("#_LeaveTotalDaysApplied").val(0),$("#eLeaveBalance").html("0.00"),$("#eLeaveTotalDaysToApply").html(l),$("#_LeaveTotalDaysToApply").val(l),d=0):($("#eLeaveTotalDaysToApply").html(l),$("#_LeaveTotalDaysToApply").val(l),d=StringToFloat($("#eLeaveBalance").html())-StringToFloat($("#eLeaveTotalDaysToApply").html())),$("#LeaveBalanceAfter").css("background-color","white"),$("#LeaveBalanceAfter").css("color","black"),mAlert.Hide(),DisableSaveSubmit(!1);var v="white",p="black";0>d&&(AllowedNegativeBalance?AllowedNegativeBalance&&d<NegativeLeaveAllocationLimit&&(mAlert.Show("AlertDiv","Your Advance Leave is not Permitted.",LeaveMessage),DisableSaveSubmit(!0),v="red",p="white"):(mAlert.Show("AlertDiv","Advance Leave is not Permitted for your Site.","Please Contact your Local HR!"),DisableSaveSubmit(!0),v="red",p="white"),$("#LeaveBalanceAfter").css("background-color",v),$("#LeaveBalanceAfter").css("color",p),$("#LeaveBalanceAfter").css("font-weight","bold")),$("#LeaveBalanceAfter").html(CurrencyFormat(d)),CheckCorssDate()}}})}function CancelLeave(){var e=$("#_LeaveStatusID").val(),a="",t=$("#LeaveStartDate").jqxDateTimeInput("getDate"),r=$("#_ApplicantID").val(),o=$("#_UserID").val(),l=($("#_LocalHRID").val(),new Date);return r!=o&&1!=HRFullAccess?(a="Sorry, Only the Applicant and the Local HR can cancel this request",a+="\nPlease Contact your Local HR for more Info.",MessageBoxAlert(a,BootstrapDialog.TYPE_WARNING),!1):FormatDate(t)<FormatDate(l)&&3==e&&1!=HRFullAccess?(a="Sorry, You can only Cancel your Leave Request Before the Start Date!",a=a+"\n<b>StartDate</b>: "+FormatDate(t)+"\n<b>CurrentDate</b>: "+FormatDate(l),a+="\nPlease Contact your Local HR for more Info.",MessageBoxAlert(a,BootstrapDialog.TYPE_WARNING),!1):(2==e?a="This Leave request is in the Process for Approval,\nAre you sure you want to Cancel it?":3==e&&(a="This Leave request has already been approved,\nDo you still want to Cancel this Leave Request?"),void MessageBoxEx(a,BootstrapDialog.TYPE_DANGER,"CancelLeaveApplication"))}function ExecuteCreditLeaveNow(){var e=$("#_CreditLeaveID").val(),a=$("#_LeaveIsSubmit").val(),t=$("#LeaveApplicant").select2("val"),r=$("#LeaveRecipient").select2("val"),o=FormatDate($("#LeaveStartDate").jqxDateTimeInput("getDate"),"yyyy-mm-dd"),l=FormatDate($("#LeaveEndDate").jqxDateTimeInput("getDate"),"yyyy-mm-dd"),n=BooleanToInteger($("#LeaveHalfDayAM").jqxRadioButton("checked")),s=BooleanToInteger($("#LeaveHalfDayPM").jqxRadioButton("checked")),i=$("#_LeaveTypeID").val(),c=StringToFloat($("#eLeaveTotalDaysToApply").html()),d=$("#LeaveRemarks").text(),v=$("#_LocalHRID").val(),p=$("#_LeaveApproverID").val(),u=$("#_CurrentUserID").val(),y=e+"|"+a+"|"+t+"|"+r;y=y+"|"+o+"|"+l+"|"+n+"|"+s,y=y+"|"+i+"|"+c+"|"+d+"|"+v,y=y+"|"+p+"|"+u,ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:30,Param:y},success:function(e,t){var r=t;if(r){var o=e.split("|");parseInt(o[1])>=0?1==a?document.location="dashboard.php":document.location="leave-credit-application.php?action=view&id="+o[0]:(MessageBoxAlert("Error Saving/Submitting Leave Credit Application, \nPlease Check your data.",BootstrapDialog.TYPE_DANGER),HideProgressBar())}}})}function ExecuteLeaveNow(){ViewProgressBar();var e=$("#_LeaveID").val(),a=$("#_ApproverID").val(),t=$("#_LeaveCompanyID").val(),r=$("#_LeaveDateApplied").val(),o=$("#_LeaveReference").val(),l=$("#_LeaveCurrentYearEntitled").val(),n=$("#_LeaveCurrentYearEntitledProRata").val(),s=$("#_LeaveCarryForward").val(),i=$("#_LeaveCarryForwardBalance").val(),c=$("#_LeaveBalance").val(),d=$("#_LeaveTotalDaysApplied").val(),v=$("#_LeaveTotalDaysToApply").val(),p=$("#_LeaveIsSubmit").val(),u=$("#_LeaveApplicant").val(),y=$("#LeaveRecipient").select2("val"),m=$("#LeaveTypeList").select2("val"),g=$("#LeaveStartDate").jqxDateTimeInput("getDate"),L=$("#LeaveEndDate").jqxDateTimeInput("getDate"),D=$("#LeaveRemarks").text(),h=$("#LeaveHalfDayAM").jqxRadioButton("checked")?1:0,f=$("#LeaveHalfDayPM").jqxRadioButton("checked")?1:0,C=$("#LeaveFourthDay").jqxRadioButton("checked")?1:0,S=$("#_LeaveStatusID").val(),x=$("#_LeaveCredit").val(),B=$("#_RowStatusID").val();$.ajax({type:"POST",url:"../pages/leaveupdate.php",data:{lid:e,lda:FormatDate(r,"yyyy-mm-dd"),lref:o,ls:p,lsi:S,la:u,lr:y,lsd:FormatDate(g,"yyyy-mm-dd"),led:FormatDate(L,"yyyy-mm-dd"),lha:h,lhp:f,lfd:C,ltl:m,re:D,cy:l,cyp:n,lcf:s,lcfb:i,lbc:c,lt:d,lta:v,lci:t,lai:a,lc:x,rsi:B},success:function(e,a){var t=a;if(t){var r=e.split("|");if(parseInt(r[0])>0){var o="Date Request Conflict!",l="to a pending/approved leave request from "+FormatDate($("#LeaveStartDate").jqxDateTimeInput("getDate"));l+="-"+FormatDate($("#LeaveEndDate").jqxDateTimeInput("getDate")),l+="<br>Please Check your Date Entries.",mAlert.Show("AlertDiv",o,"The System has Detected a conflict of leave date<br>"+l),HideProgressBar()}else 1==p?document.location="dashboard.php":document.location="leave.php?id="+r[1]}}})}function InsertUpdateSite(){var e=$("#_SiteID").val(),a=$("#SiteCountry").select2("val"),t=$("#Site").val(),r=$("#SiteActive").jqxCheckBox("checked")?1:0,o=$("#SiteAllowNegativeCredit").jqxCheckBox("checked")?1:0,l=$("#_SiteStatus").val(),n=$("#_RowIndex").val(),s=e+"|"+a+"|"+t+"|"+r;s+="|"+o+"|"+l+"|"+n,ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:7,Param:s},success:function(e,a){var t=a;if(t)if(e>0)document.location=location.href;else{var r="Error on saving Site.";mAlert.Show("AlertDiv",r,"Please check your entry."),HideProgressBar()}}})}function InsertUpdateEmployeeDetails(){var e=$("#_EmploymentDetailID").val(),a=$("#EmploymentUser").select2("val"),t=FormatDate($("#EmploymentDateHired").jqxDateTimeInput("getDate"),"yyyy-mm-dd"),r=$("#EmploymentStatusList").select2("val"),o=$("#EmploymentPosition").val(),l=$("#EmploymentCategoryList").select2("val"),n=$("#SiteList").select2("val"),s=$("#EmploymentActive").prop("checked")?1:0,i=$("#_EmploymentRowStatus").val(),c=e+"|"+a+"|"+t+"|"+r;c+="|"+o+"|"+l,c+="|"+n+"|"+s+"|"+i,ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:8,Param:c},success:function(e,a){var t=a;if(t){if(0==e)document.location=location.href,HideBootstrapTooltips();else{var r="Error on saving Employment Details.";mAlert.Show("AlertDiv",r,"Please check your entries.")}HideProgressBar()}}})}function GenerateRestDaysXML(){var e=new XMLWriter;e.BeginNode("entry");var a=tclass.rowCount;for(e.BeginNode("restdays"),i=1;i<=a;i++)e.BeginNode("restday"),e.Node("RestDayID",tclass.CurrentCell(0,i)),e.Node("UserID",tclass.CurrentCell(1,i)),e.Node("RestDay",FormatDate(tclass.CurrentCell(4,i),"yyyy-mm-dd")),e.Node("RestDayStatus",tclass.CurrentCell(2,i)),e.EndNode();e.EndNode(),e.Close();var t=e.xml();return t}function InsertRestDaysXML(){var e=GenerateRestDaysXML();ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:10,Param:e},success:function(e,a){var t=a;if(t){var r=e.split("|");if(0==r[1])location="../pages/rest-days.php?uid="+r[0];else{var o="Error On Saving Rest Days.";mAlert.Show("AlertDiv",o,"Please check your entries.")}HideProgressBar()}}})}function ExecuteAdditionalLeaveCredit(){try{var e=($("#tblLeavebalanceProfileList>tbody>tr").length-1,EmployeeIDList),a=FormatDate($("#DateEffectivity").jqxDateTimeInput("getDate"),"yyyy-mm-dd"),t=$("#MonthExpiration").select2("val"),r=$("#LeaveDayUsed").val(),o=$("#LeaveDayToAdd").val(),l=$("#LeaveReason").text(),n=$("#AddionalCreditLeaveType").select2("val"),s=new Date,i=s.getFullYear(),c=$("#SiteList").select2("val");c=c+"|"+$("#_UserID").val(),c=c+"|"+a,c=c+"|"+t,c=c+"|"+l,c=c+"|"+o,c=c+"|"+i,c=c+"|"+e,c=c+"|"+r,c=c+"|"+n}catch(d){alert(d.message)}$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:22,Param:c},success:function(e,a){var t=a;t&&location.reload()}})}function InsertUpdateLeaveBalanceProfile(){var e=parseInt($("#LeaveAllocationID").val()),a=$("#LeaveTypeList").select2("val"),t=$("#LeaveRecipient").select2("val"),r=$("#LeaveCurrentYear").select2("val"),o=StringToFloat($("#LeaveEntitled").val(),2),l=StringToFloat($("#CarryForward").val(),2),n=StringToFloat($("#CarryForwardBalance").val(),2),s=StringToFloat($("#TotalLeaveTaken").val(),2),i=StringToFloat($("#leaveCancelledLeave").val(),2),c=StringToFloat($("#leaveForfeitureLeave").val(),2),d=StringToFloat($("#leaveCreditAmount").val(),2),v=$("#_RowStatus").val(),p=e+"|"+a+"|"+t+"|"+r;p+="|"+o+"|"+l,p+="|"+n+"|"+s,p+="|"+i+"|"+c+"|"+d+"|"+v,ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:6,Param:p},success:function(e,a){var t=a;if(t){if(0==e)location.reload();else{var r="Error on saving Leave Balance Profile.";mAlert.Show("LeaveBalanceAlert",r,"Please check your entry.")}HideProgressBar()}}})}function CurrencyFormat(e,a){"undefined"==typeof a&&(a=2);var t=".",r=",";e=parseFloat(e);var o=0>e?"-":"",l=new String(e.toFixed(a));t.length&&"."!=t&&(l=l.replace(/\./,t));var n="",s="",i=new String(l),c=t.length?i.indexOf(t):-1;for(c>-1?(c&&(n=i.substr(0,c)),s=i.substr(c+1)):n=i,n&&(n=String(Math.abs(n)));s.length<a;)s+="0";for(temparray=new Array;n.length>3;)temparray.unshift(n.substr(-3)),n=n.substr(0,n.length-3);return temparray.unshift(n),n=temparray.join(r),o+n+t+s}function StringToFloat(e,a){"undefined"==typeof a&&(a=2);var t=e.replace(",","").replace(" ","");t=t.replace(",","").replace(" ",""),t=parseFloat(t);var t=t.toFixed(a);return t}function AcknowledgeCreditLeaveRequest(){MessageBoxEx("Are you sure you want to acknowledge this Credit Leave Request?",BootstrapDialog.TYPE_DANGER,"ExecuteAcknowledgeCreditLeaveRequest","HideProgressBar")}function ExecuteAcknowledgeCreditLeaveRequest(){var e=$("#_CreditLeaveID").val(),a=$("#_CreditLeaveIDMD5").val(),t=$("#_CurrentUserID").val();ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:31,Param:e+"|"+t},success:function(e,t){var r=t;r&&(document.location="leave-credit-application.php?status=view&id="+a)}})}function AcknowledgeCancelLeaveRequest(){MessageBoxEx("Are you sure you want to approve this Cancel Leave Request?",BootstrapDialog.TYPE_DANGER,"ExecuteCancelLeaveRequest","HideProgressBar")}function ExecuteCancelLeaveRequest(){var e=$("#_LeaveID").val(),a=$("#_LeaveIDMD5").val(),t=$("#_UserID").val();ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:21,Param:e+"|"+t},success:function(e,t){var r=t;r&&(document.location="leave.php?id="+a)}})}function CancelLeaveApprove(e){var a=$("#_LeaveID").val(),t=$("#LeaveApplicant").select2("val");ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:20,Param:a+"|"+t+"|"+e},success:function(e,a){var t=a;t&&location.reload()}})}function CancelLeaveSubmission(e){var a=$("#_LeaveID").val(),t=$("#LeaveApplicant").select2("val");ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:4,Param:a+"|"+t+"|"+e},success:function(e,a){var t=a;t&&location.reload()}})}function ApproveRejectLeaveRequest(e){var a,t,r,o=0,l=$("#LeaveStartDate").jqxDateTimeInput("getDate"),n=new Date(l),s=n.getFullYear()-1,i=$("#LeaveTypeList").select2("data").text,c=parseFloat($("#eLeaveTotalDaysToApply").html()),d=LeaveBalanceForApproval-c,v=LeaveBalanceForApproval<c,p=AllowedNegativeBalance,u=NegativeLeaveAllocationLimit,y=Math.abs(u)<Math.abs(d),m=v&&(!p||p&&y),g=$("#LeaveTypeList").select2("val"),L=LeaveTypeArray[g];if(m&&1==parseInt(L)){var D="Cannot Approve Leave request with Days Applied Exceeds the limit!";return D+="\n<strong>Details of Request:</strong>",D=D+"\n&nbsp;&nbsp;&nbsp;Days To Apply: "+c,D=D+"\n&nbsp;&nbsp;&nbsp;Current Balance Remaining for "+i+": "+LeaveBalanceForApproval,D=D+"\n&nbsp;&nbsp;&nbsp;Allow Advance Leave: "+p.toString().toUpperCase(),D=D+"\n&nbsp;&nbsp;&nbsp;Advance Leave Allocation Limit: "+Math.abs(u),D+="\n<strong>Note: Please Reject this Request.</strong>",MessageBoxAlert(D,BootstrapDialog.TYPE_DANGER),!1}if(1==o){var h="Leave Application cannot be approve/reject, Profile Balance has not yet been reset.\nYear "+s+" has not yet been closed.";return MessageBoxAlert(h,BootstrapDialog.TYPE_INFO),!1}0==e?(a="Are you sure you want to Reject this Leave Request?",t="RejectLeaveRequest",r=BootstrapDialog.TYPE_DANGER):(a="Are you sure you want to Approved this Leave Request?",t="ApproveLeaveRequest",r=BootstrapDialog.TYPE_INFO),MessageBoxEx(a,r,t,"HideProgressBar")}function InitializeCalendar(e,a){void 0==a&&(a=!0),$(e).jqxCalendar({width:"200px",height:"200px",selectionMode:"default",disabled:!a,theme:"summer"})}function RejectLeaveRequest(){var e=0,a=$("#_LeaveID").val(),t=$("#_UserID").val(),r=$("#LeaveApproverComment").text();"Please Enter Comment to be able to Reject"==r&&(r="");var o=a+"|"+t+"|"+r+"|"+e;ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:5,Param:o},success:function(e,a){var t=a;if(t){0==e?MessageBoxAlert("Sending Email Notification failed, Please check your email provider!",BootstrapDialog.TYPE_DANGER,"ReloadPage"):ReloadPage()}}})}function ReloadPage(){location.reload()}function ApproveLeaveRequest(){var e=1,a=$("#_LeaveID").val(),t=$("#_UserID").val(),r=$("#LeaveApproverComment").text(),o=a+"|"+t+"|"+r+"|"+e;ViewProgressBar(),$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:5,Param:o},success:function(e,a){var t=a;t&&(0==e&&MessageBoxAlert("Sending Email Notification failed, Please check your email provider!",BootstrapDialog.TYPE_DANGER),location.reload())}})}function GetCompanyDepartment(e){$.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:3,Param:e},success:function(e,a){var t=a;if(t){var r=JSON.parse(e),o=""==r.Company;if(o){var l="The system has detected you haven't configured yet your employment details.",n="Please contact HR to configure employment details for "+r.Employee+"!";mAlert.Show(l,n)}$("#LeaveList").prop("disabled",o),$("#LeaveRecipientCompanyCode").val(r.CompanyCode+"-"+r.Company),$("#LeaveApplicantDepartment").val(r.Department),$("#_LeaveCompanyID").val(r.CompanyID)}}})}function DefaultLeaveCreditValues(){$("#eLeaveCurrentYearEntitled").html("0.00"),$("#eLeaveBalanceForwarded").html("0.00"),$("#_LeaveCarryForward").val(0),$("#eLeaveBalance").html("0.00"),$("#_LeaveBalance").val(0),$("#eLeaveTotalDaysApplied").html("0.00"),$("#_LeaveCurrentYearEntitled").val(0),$("#_LeaveBalanceCredit").val(0),$("#_LeaveTotalDaysApplied").val(0);var e=$("#LeaveTypeList").select2("data").text;$("#_CurrentYearEntitledLabel").html("Leave Entitlement"),
$("#_CurrentYearEntitledProRataLabel").html(e+"-ProRata"),$("#eLeaveCurrentYearEntitledProRata").html("0.00"),$("#_LeaveCurrentYearEntitledProRata").val(0),$("#eLeaveCarryForwardBalance").html("0.00"),$("#_LeaveCarryForwardBalance").val(0),$("#eLeaveTotalEntitlement").html("0.00"),$("#eLeaveLeaveCredit").html("0.00"),$("#_LeaveCredit").val(0),$("#LeaveBalanceAfter").html(CurrencyFormat(0)),$("#eLeaveTotalDaysToApply").html(CurrencyFormat(0)),$("#LeaveBalanceAfter").css("background-color","white"),$("#LeaveBalanceAfter").css("color","black")}function GetLeaveCredits(e,a,t){var r=e+"|"+a+"|"+t;return 1900==t?(DefaultLeaveCreditValues(),1):void $.ajax({type:"POST",url:"../class/ajax.php",data:{nIndex:2,Param:r},success:function(e,a){var t=a;if(t){var r=JSON.parse(e);$("#eLeaveCurrentYearEntitled").html(r.LeaveEntitlement),$("#eLeaveBalanceForwarded").html(r.CarryForward),$("#_LeaveCarryForward").val(r.CarryForward),$("#eLeaveBalance").html(r.LeaveBalance),$("#_LeaveBalance").val(r.LeaveBalance),$("#eLeaveTotalDaysApplied").html(r.TotalLeaveTaken),$("#_LeaveCurrentYearEntitled").val(r.LeaveEntitlement),$("#_LeaveBalanceCredit").val(r.LeaveBalance),$("#_LeaveTotalDaysApplied").val(r.TotalLeaveTaken),$("#LeaveTypeLabel").html(r.ShowLeaveType),$("#_CurrentYearEntitledLabel").html("Leave Entitlement"),$("#_CurrentYearEntitledProRataLabel").html(r.LeaveType+"-ProRata"),$("#eLeaveCurrentYearEntitledProRata").html(r.LeaveEntitlementProRata),$("#_LeaveCurrentYearEntitledProRata").val(r.LeaveEntitlementProRata),$("#eLeaveCarryForwardBalance").html(r.CarryForwardBalance),$("#_LeaveCarryForwardBalance").val(r.CarryForwardBalance),$("#eLeaveTotalEntitlement").html(r.TotalEntitlement),$("#eLeaveLeaveCredit").html(r.LeaveCreditAlloc),$("#_LeaveCredit").val(r.LeaveCreditAlloc),LeaveMessage=r.LeaveMessage,NegativeLeaveAllocationLimit=r.NegativeLeaveAllocationLimit,$("#LeaveBalanceAfter").html(CurrencyFormat(0)),$("#eLeaveTotalDaysToApply").html(CurrencyFormat(0)),ComputeDaysApplied(AllowOneFourthDay),$("#LeaveBalanceAfter").css("background-color","white"),$("#LeaveBalanceAfter").css("color","black"),r.LeaveCredit<=0?$(".Leave-Credit").hide():$(".Leave-Credit").show(),r.LeaveEntitlementProRata<=0?$(".ProRate-Entry").hide():$(".ProRate-Entry").show(),r.CarryForward<=0?$(".Carry-Forward").hide():$(".Carry-Forward").show()}}})}$(document).ready(function(){$("#InputIcon").change(function(e){$("#InputSelectedicon").removeClass(),$("#InputSelectedicon").addClass(e.val)}),$("#LeaveLock").bind("contextmenu",function(e){return!1}),$(".table-clickable").on("click",".clickable-row",function(e){$(this).addClass("active").siblings().removeClass("active")})});var getLocalization=function(){var e={};e.pagerGoToPageString="Go to Page:",e.pagerShowRowsString="Show Row:",e.pagerRangeString=" of ",e.pagerNextButtonString="next",e.pagerFirstButtonString="first",e.pagerLastButtonString="last",e.pagerPreviousButtonString="Previous",e.sortAscendingString="Sort Ascending",e.sortDescendingString="Sort Descending",e.sortRemoveString="Remove Sort",e.firstDay=1,e.percentSymbol="%",e.currencySymbol=" ",e.currencySymbolPosition="before",e.decimalSeparator=".",e.thousandsSeparator=",";var a={names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]};e.days=a;var t={names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},r={d:"MM/dd/yyyy",D:"dddd, d. MMMM yyyy",t:"HH:mm",T:"HH:mm:ss",f:"dddd, d. MMMM yyyy HH:mm",F:"dddd, d. MMMM yyyy HH:mm:ss",M:"dd MMMM",Y:"MMMM yyyy"};return e.patterns=r,e.months=t,e};$("#vehicle").select2().on("change",function(e){if(e.added){var a="";$(".select2-search-choice div").filter(function(){return a='<span style="color: green" class="glyphicon glyphicon-'+e.added.css+'">&nbsp;</span>',$(this).text()==e.added.id}).prepend(a)}});
